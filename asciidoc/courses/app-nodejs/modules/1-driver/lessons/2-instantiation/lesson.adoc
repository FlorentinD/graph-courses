= Instantiating the Driver
:order: 2


== Installing the Driver

Firstly, you will need to install the link:https://neo4j.com/developer/javascript[Neo4j JavaScript Driver^].  The Neo4j JavaScript Driver is one of five officially supported drivers, the others are Java, .NET, Python and Go.

The Neo4j JavaScript Driver is available through the npm registry and can be installed with either `npm` or `yarn`.


[.tab]
.NPM
====
To install using link:https://www.npmjs.com/[NPM^], run the following command.

.NPM
[source,shell]
npm install --save neo4j-driver

The `--save` option will save a reference to the `neo4j-driver` package in your `package.json` file.

====

[.tab]
.Yarn
====

To install using link:https://yarnpkg.com/[Yarn^], run the following command.

.Yarn
[source,shell]
yarn add --save neo4j-driver

The `--save` option will save a reference to the `neo4j-driver` package in your `package.json` file.
====

== Creating a Driver Instance

Each driver instance will connect to one server, or cluster of servers depending on the value provided in the connection string.

The `neo4j-driver` package exports a default `neo4j` object.  This object provides a `driver` method for creating a new driver instance.  The `driver` method takes two arguments:

1. **A connection string** for the Neo4j instance or cluster - for example `neo4j://localhost:7687` or `neo4j+s://_dbhash_.databases.neo4j.io:7687`
2. **An authentication token** - Neo4j supports basic username and password authentication, kerberos tokens or custom authentication.  These can be created through the `neo4j.auth` variable.


Here is an example for how to create a driver instance:

.Creating a Driver Instance
[source,js]
----
import neo4j from 'neo4j'

const driver = neo4j.driver('neo4j://localhost:7687', neo4j.auth.basic('neo4j', 'letmein!'))
----

The above example creates an _unencrypted_ connection to the Neo4j server at `localhost` on the default port number of `7687`.
The driver then attemps to authenticate against the server using a basic authentication with the username `neo4j` and password `letmein!`.


=== Verifying Connectivity

You can verify that the connection details used during driver instantiation are correct by calling the `verifyConnectivity` function.
This function returns a Promise which resolves, or rejects with a `Neo.ClientError.Security.Unauthorized` error if a connection could not be made.

.Verify Connectivity
[source,js]
await driver.verifyConnectivity()

=== Troubleshooting Connectivity Issues

If the driver is unsuccessful, you may see one of the following error messages:


==== Incorrect Server URL

[source]
UnhandledPromiseRejectionWarning: Neo4jError: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1634844853479, routers=[], readers=[], writers=[]]


==== Incorrect Username and Password

[source]
Neo4jError: The client is unauthorized due to authentication failure.
  code: 'Neo.ClientError.Security.Unauthorized'





// == Instantiating the Driver

// Depending on the connection string, a Driver will either connect to a single instance of Neo4j or a Causal Cluster of Neo4j servers.


// Each driver object connects to a single instance of Neo4j using a server address argument, and in most cases an authentication token.

// You should create a single instance of the driver per application for each Neo4j instance that you wish to connect to.


// .Creating a Driver Instance
// [source,js]
// ----
// import neo4j from 'neo4j'

// const driver = neo4j.driver('neo4j://localhost:7687', neo4j.auth.basic('neo4j', 'letmein!'))
// ----

// The above example connects to a Neo4j instance running at `localhost` on port `7687`.
// The second argument in the function call is to create a _basic_ authentication token (username and password) using the username `neo4j` and the password `letmein!`.


// === Building your Connection String

// A connection string consists of four elements.

// 1. The **scheme** used to connect to the Neo4j instance - for example `neo4j` (required)
// 2. The server address for the Neo4j Service - for example `localhost` (required)
// 3. The **port number** that the Neo4j service is running on (required if not the default value of `7687`)
// 4. Additional connection configuration (for example the routing context)

// == Choosing your Scheme


//   * `neo4j` - Creates an unencrypted connection to Neo4j.  If you are connecting to a local Neo4j instance or have not explicitly turned on encryption then this is most likely the option you are looking for
//   * `neo4j+s` - Creates an encrypted connection to Neo4j
