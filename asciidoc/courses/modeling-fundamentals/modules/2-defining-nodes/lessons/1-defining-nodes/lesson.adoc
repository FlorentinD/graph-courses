= Defining nodes
:type: quiz
:order: 1

[.video]
video::xxxx[youtube,width=560,height=315]


[.transcript]

== Defining node labels

Entities are the dominant nouns in your application questions:

. What *ingredients* are used in a *recipe*?
. Who is married to this *person*?

The entities of your use cases or questions will be the labeled nodes in the graph data model.

In the Movie domain, we use the *nouns* in our questions to define the node labels, for example:

. What *people* acted in a *movie*?
. What *person* directed a *movie*?
. What *movies* did a *person* act in?

Here are some of the labeled nodes that we will start with.

image::images/movie-person-labels.png[Starting labels,width=400,align=center]

=== Node properties

Node properties are used to:

* Uniquely identify a node.
* Answer specific details of the application questions.
* Return data.

In a Cypher query, properties are used to:

* Anchor (where to begin the query).
** MATCH (p:Person *{name: 'Tom Hanks'}*)-[:ACTED_IN]-(m:Movie) RETURN m
* Traverse the graph (navigation).
** MATCH (p:Person)-[:ACTED_IN]-(m:Movie *{title: 'Apollo 13'}*)-[:RATED]-(u:User) RETURN p,u
* Return data from the query.
** MATCH (p:Person {name: 'Tom Hanks'})-[:ACTED_IN]-(m:Movie) RETURN *m.title, m.released*

=== Unique identifiers in Movie graph

In the Movie graph, we use the following properties to uniquely identify our nodes:

* Person.tmdbId
* Movie.tmdbId

=== Properties for nodes

In addition to the ID that is used to uniquely identify a node, we must revisit the domain questions to determine the type of data a node must hold.

Here is a partial list of our domain questions specific to _Person_ and _Movie_ nodes.
These questions inform us about the data we need in _Movie_ and _Person_ nodes.

. What people acted in a movie?
.. Identify a movie by its *title*.
.. Return the *names* of the actors.
. What person directed a movie?
.. Identify a movie by its *title*.
.. Return the *name* of the director.
. What movies did a person act in?
.. Identify a person by their *name*.
.. Return the *titles* of the movies.
. Who was the youngest person to act in a movie?
.. Identify a movie by its *title*.
.. Evaluate the *ages* of the actors.
.. Return the *name* of the actor.
. What is the highest rated movie in a particular year according to imDB?
.. Identify all movies *released* in a particular year.
.. Evaluate the *imDB ratings*.
.. Return the movie *title*.
. What drama movies did an actor act in?
.. Identify the actor by *name*.
.. Evaluate the *genres* for the movies the actor acted in.
.. Return the movie *titles*.

Given this information from the questions, here are the properties we will define for the _Movie_ nodes:

* Movie.title (string)
* Movie.released (date)
* Movie.imdbRating (decimal between 0-10)
* Movie.genres (list of strings)

Here are the properties we will define for the _Person_ nodes:

* Person.name (string)
* Person.born (date)
* Person.died (date)

Note: The _died_ property will be optional.

Here is the initial data model:

image::images/before-challenge-data-model.png[Data model,width=400,align=center]

And here is the initial instance model you will be working with:

image::images/before-challenge-instance-model.png[Instance model,width=400,align=center]

Run this Cypher code to add the Person and Movie nodes to the graph:

[TIP]
Click the *Run in Sandbox* button to the top right of the code sample to open the Sandbox to the right and run the query.

[source,cypher]
----
MERGE (:Movie {title: "'Apollo 13'", tmdbId: 568, released: "'1995-06-30'", imdbRating: 7.6, genres: "['Drama', 'Adventure', 'IMAX']"})
MERGE (:Person {name: "'Tom Hanks'", tmdbId: 31, born: "'1956-07-09'"})
MERGE (:Person {name: "'Meg Ryan'", tmdbId: 5344, born: "'1961-11-19'"})
MERGE (:Person {name: "'Danny DeVito'", tmdbId: 518, born: "'1944-11-17'"})
MERGE (:Movie {title: "'Sleepless in Seattle'", tmdbId: 858, released: "'1993-06-25'", imdbRating: 6.8, genres: "['Comedy', 'Drama', 'Romance']"})
MERGE (:Movie {title: "'Hoffa'", tmdbId: 10410, released: "'1992-12-25'", imdbRating: 6.6, genres: "['Crime', 'Drama']"})
MERGE (:Person {name: "'Jack Nicholson'", tmdbId: 514, born: "'1937-04-22'"})
----


You can verify that the nodes have been created with this code:

[source,cypher]
----
MATCH (n) RETURN n
----

== Check your understanding

include::questions/1-labels.adoc[]

include::questions/2-properties.adoc[]

[.summary]
== Summary

In this lesson, you learned that a good starting point for your data modeling is to come up with a set of questions for the use cases and identify the entities from the questions.
In the next challenge, you will further develop the model by adding another labeled node to the model.