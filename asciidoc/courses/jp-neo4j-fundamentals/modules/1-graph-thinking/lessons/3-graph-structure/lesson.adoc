= グラフ構造
// :type: video
:type: quiz
:order: 3

// [.video]
// video::cj8N1VaKtV8[youtube,width=560,height=315]

[.transcript]
== グラフの性質とトラバーサル

グラフの特性にはいくつかの種類がある。
また、質問に答えるためにグラフを走査する方法も数多くある。

=== 有向グラフと無向グラフ

image::images/michael-sarah-undirected.jpg[Michael and Sarah are married to each other, role=right]

無向グラフでは、リレーションシップは双方向または対称とみなされる。

無向グラフの例として、結婚の概念がある。
MichaelとSarahが結婚していれば、SarahもMichaelと結婚していると考えることができます。

有向グラフは、グラフにさらに情報の次元を追加する。
同じタイプで反対方向にあるリレーションシップは、異なる意味合いを持つ。

image::images/michael-sarah-directed.jpg[Michael and Sarah have different strengths of their love, role=left]

例えば、結婚が左右対称の関係だとしたら、愛の概念は左右非対称です。
二人が互いに好きであったり、愛していたりしても、その量には大きな差があります。
方向性のあるリレーションシップは、多くの場合、何らかの重み付けで修飾することができます。
ここでは、LOVES関係の強さが、ある人が他の人をどれだけ愛しているかを表していることがわかる。

より大きなスケールでは、社会的なつながりの大規模なネットワークは、ネットワーク効果を理解し、情報や病気の伝達を予測するために使用することもできる。
人と人とのつながりの強さがあれば、情報がネットワークを通じてどのように広がるかを予測することができる。

=== 重み付きグラフと非重み付きグラフの比較

愛の概念もまた、重み付きグラフの一例である。

重み付きグラフでは、ノード間のリレーションは、例えばコスト、時間、距離、優先度など、様々な尺度を表す値を持つ。

基本的な最短経路アルゴリズムでは、グラフ内の2つのノード間の最短距離を計算する。
これは、近所の店までの最短の徒歩ルートを見つけたり、都市から都市への移動に最も効率的なルートを計算したりするのに役立つだろう。

image::images/roads.jpg[Roads between cities]

この例では、このグラフに対して、次のような質問が考えられます。スプリングフィールドからセンタービルへの最短のドライブは何ですか？
HAS_ROAD_のリレーションシップとその距離を用いると、スプリングフィールドから出発し、クリフサイド、ニュータウンと進み、最後にセンタービルに到着するのが最短のドライブとなることがわかる。

より複雑な最短経路アルゴリズム（例えば、ダイクストラアルゴリズムやA*探索アルゴリズム）では、最短経路を計算する際にリレーションシップの重み付け特性を考慮する。
例えば、国際宅急便で荷物を送る場合、早く届くように空路で送ることを好むかもしれないが、その場合、ある地点から次の地点まで行くのにかかる時間を重み付けとして考慮することになる。

逆に、コストが問題であれば、船便で荷物を送ることを好むでしょうから、荷物を送るコストを表すプロパティを使うことになります。

=== グラフのトラバーサル

グラフのデータに関する質問に答えるには、グラフを走査するのが一般的である。
SpringfieldとCentervilleの間の最短経路を求めるには、2つの都市間のすべての経路を走査して最短経路を求める必要がある。

* スプリングフィールド-ニュータウン-センタービル = 26
* スプリングフィールド-クリフサイド-ニュータウン-センタービル = 23
* スプリングフィールド-クリフサイド-メルローズ-カーターヴィル = 49

トラバーサルは、グラフの中でリレーションシップをたどることを意味する。
グラフ理論には、アプリケーションの性能に影響を与える様々なタイプのトラバーサルがあります。
例えば、リレーションシップを複数回トラバースすることができるか、ノードを複数回訪問することができるか、などです。

Neo4jのCypherステートメント言語は、ノード・トラバーサルに最適化されているので、リレーションシップが何度もトラバースされることはなく、アプリケーションにとって大きなパフォーマンスの向上となります。

== 理解度をチェック

include::questions/1-traversal.adoc[leveloffset=+1]

[.summary]

== まとめ

このレッスンでは、グラフがどのように構成され、リレーションシップが方向と重みを持つことができるかを学びました。
次に、グラフの一般的な使用例について学びます。
